
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>

int main(int argc, char *argv[]) {
	if (argc != 2) {
		fprintf(stderr, "Usage: %s <file>\n", argv[0]);
		exit(EXIT_FAILURE);
	}

	int fd;
	if ((fd = open(argv[1], O_RDWR | O_CREAT, S_IRUSR | S_IWUSR)) == -1) {
		perror("\nErreur lors de l'ouverture du fichier !\n");
		exit(EXIT_FAILURE);
	}

	char buffer[24];
	printf("Entrez une chaine de caractères que vous voulez ajouter : ");
	if (scanf("%23s", buffer) == -1) {
		printf("Erreur lors du scanf !\n");
		exit(EXIT_FAILURE);
	}

	lseek(fd, 0, SEEK_END);
	if (write(fd, buffer, sizeof(buffer)) == -1) {
		perror("Erreur lors de l'écriture dans le fichier !\n");
		exit(EXIT_FAILURE);
	}
	printf("\nEcriture de %s dans %s !\n", buffer, argv[1]);

	lseek(fd, 0, SEEK_SET);
	while (read(fd, buffer, sizeof(buffer)) > 0) {
		printf("\nMot : %s", buffer);
	}

	if (close(fd) == -1) {
		perror("Erreur lors de la fermeture du fichier !\n");
		exit(EXIT_FAILURE);
	}

	printf("\n");
	return EXIT_SUCCESS;
}

