
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/wait.h>
#include <sys/types.h>
#include <sys/stat.h>
#include <sys/siginfo.h>
#include <time.h>
#include <signal.h>

#define Stou_0 "\033[0m"	// RESET
#define Stou_R "\033[0;31m" // RED
#define Stou_G "\033[0;32m" // GREEN
#define Stou_Y "\033[0;33m" // YELLOW

/**
 * Handler for the signal.
 * @param signum the received signal number
 */
void handler(int signum) {
	/** Nothing here */
}

int main(int argc, char *argv[]) {
	printf("\n");

	printf(Stou_G "Server started : " Stou_Y "%d" Stou_G ".\n" Stou_0, getpid());

	// Attente du signal SIGRTMIN
	struct sigaction action;
	sigemptyset(&action.sa_mask);
	action.sa_flags = 0;
	action.sa_handler = handler;
	if (sigaction(SIGRTMIN, &action, NULL) == -1) {
		perror("Error positioning the handler\n");
		exit(EXIT_FAILURE);
	}

	siginfo_t info;
	sigset_t set;
	sigemptyset(&set);
	sigaddset(&set, SIGRTMIN);

	int compteur = 0;
	int r3 = 0;
	while (compteur < 2) {
		sigwaitinfo(&set, &info);

		if (info.si_val)

		// Send the signal
		union sigval value;
		value.sival_int = 1234;
		if (sigqueue(info.si_pid, SIGRTMIN, value) == -1) {
			perror("Error sending signal");
			exit(EXIT_FAILURE);
		}
		
	}


	printf("\n");
	return EXIT_SUCCESS;
}
