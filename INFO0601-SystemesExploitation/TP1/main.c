
#include "utils.h"

int main() {
	// Initialisations
	setlocale(LC_ALL, "");
	ncurses_init();
	ncurses_colors();
	define_palettes();
	ncurses_init_mouse();

#define TESTS_TP 2

#if TESTS_TP == 1

	// Afficher bonjour au milieu de l'écran
	int posX = COLS / 2 - 1;
	int posY = LINES / 2 - 1;
	mvprintw(posY, posX, "Bonjour");

	// Gestion des inputs jusqu'à la touche 'N' pour 'NEXT'
	char ch;
	while ((ch = getch()) != 'N') {
		switch (ch) {
			case '1':
				attron(COLOR_PAIR(1));
				break;
			case '2':
				attron(COLOR_PAIR(2));
				break;
			case '3':
				attron(COLOR_PAIR(3));
				break;
		}
		mvprintw(posY, posX, "Bonjour");
	}

	// Affichage de 3 carrés de couleurs différentes
	attron(COLOR_PAIR(4));
	mvprintw(1,1, "  ");
	mvprintw(2,1, "  ");
	attron(COLOR_PAIR(5));
	mvprintw(1,3, "  ");
	mvprintw(2,3, "  ");
	attron(COLOR_PAIR(6));
	mvprintw(1,5, "  ");
	mvprintw(2,5, "  ");
	attron(COLOR_PAIR(0));

	int m_y, m_x;
	while ((ch = getch()) != 'N') {
		mvprintw(6,1, "(%d,%d)", posX, posY);
		if (ch == KEY_MOUSE) {
			mouse_getpos(&m_y, &m_x);
			if (m_y > 0 && m_y < 3) {
				if (m_x > 0 && m_x < 3)
					attron(COLOR_PAIR(1));
				else if (m_x > 2 && m_x < 5)
					attron(COLOR_PAIR(2));
				else if (m_x > 4 && m_x < 7)
					attron(COLOR_PAIR(3));
				mvprintw(posY, posX, "Bonjour %d, %d", posX, posY);
			}
		}
	}

#endif

#if TESTS_TP == 2

	WINDOW *infos = newwin(8, COLS, 0, 0);
	box(infos, 0, 0);
	WINDOW *subInfos = subwin(infos, 6, COLS - 2, 1, 1);
	scrollok(subInfos, TRUE);
	WINDOW *box = newwin(10, 10, 8, 0);

	char ch;
	int m_y, m_x;
	while ((ch = getch()) != 'N') {
		mouse_getpos(&m_y, &m_x);
		wprintw(subInfos, "Position du curseur : (%d, %d)\n", m_y, m_x);
		wrefresh(infos);
		wrefresh(subInfos);
		
		if (ch == KEY_MOUSE) {
			// Click dans la deuxième fenêtre
			if (m_y > 7 && m_y < 18 && m_x < 10) {
				mvwaddch(box ,m_y-10, m_x-10, 'X');
				wrefresh(box);
			}
		}
	}
	delwin(infos);
	delwin(box);

#endif

	// Fin du programme
	ncurses_stop();
	return EXIT_SUCCESS;
}
